<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö—Ä–∞—Ñ—Ç –•–∞–± ‚Äî –ú–µ–Ω—é –∏ –ü—Ä–µ–¥–∑–∞–∫–∞–∑</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: var(--tg-theme-bg-color, #fff);
            --hint-color: var(--tg-theme-hint-color, #999);
            --text-color: var(--tg-theme-text-color, #000);
            --button-color: var(--tg-theme-button-color, #3390ec);
            --secondary-bg: var(--tg-theme-secondary-bg-color, #f4f4f5);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--secondary-bg);
            color: var(--text-color);
            margin: 0; padding: 0;
        }

        header {
            background: var(--bg-color);
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid rgba(0,0,0,0.08);
            position: sticky; top: 0; z-index: 10;
        }

        .category-title {
            padding: 20px 15px 10px;
            font-size: 20px;
            font-weight: 800;
            color: var(--button-color);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .order-options {
            background: var(--bg-color);
            margin: 10px;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .order-options label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .order-options select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.1);
            background: var(--secondary-bg);
            color: var(--text-color);
            font-size: 16px;
        }

        .menu-container { padding: 10px; padding-bottom: 100px; }

        .item-card {
            background: var(--bg-color);
            border-radius: 16px;
            display: flex;
            padding: 12px;
            margin-bottom: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.03);
        }

        .item-img {
            width: 90px; height: 90px;
            border-radius: 12px;
            background: #eee;
            margin-right: 12px;
            background-size: cover;
            background-position: center;
            flex-shrink: 0;
        }

        .item-info { flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .item-title { font-weight: 700; font-size: 16px; }
        .item-desc { font-size: 12px; color: var(--hint-color); margin: 4px 0; line-height: 1.2; }
        .item-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 8px; }
        .item-price { font-weight: 800; color: var(--button-color); }

        .add-btn {
            background: var(--button-color);
            color: #fff;
            border: none;
            padding: 6px 16px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 13px;
        }

        .counter { display: none; align-items: center; gap: 10px; }
        .counter-btn { width: 30px; height: 30px; border-radius: 50%; border: 1px solid var(--button-color); background: none; color: var(--button-color); font-weight: bold; font-size: 18px; display: flex; align-items: center; justify-content: center; padding: 0; }
        .num-display { font-weight: bold; min-width: 20px; text-align: center; }
    </style>
</head>
<body>

<header>
    <div style="font-weight: bold; font-size: 18px;">–ö—Ä–∞—Ñ—Ç –•–∞–± üç∫</div>
</header>

<div class="order-options">
    <label>üïí –ö–æ–≥–¥–∞ –ø–æ–¥–∞—Ç—å –±–ª—é–¥–∞?</label>
    <select id="order-time">
        <option value="üçΩ –ö –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Å—Ç–æ–ª–∏–∫—É">–ö –º–æ–µ–º—É –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—é</option>
        <option value="üöÄ –ö–∞–∫ –º–æ–∂–Ω–æ —Å–∫–æ—Ä–µ–µ">–ö–∞–∫ –º–æ–∂–Ω–æ —Å–∫–æ—Ä–µ–µ</option>
    </select>
</div>

<div id="menu-content">
    </div>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    const categories = {
        'sets': 'üî• –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–µ—Ç—ã',
        'snacks': 'üç∫ –ó–∞–∫—É—Å–∫–∏ –∫ –∫—Ä–∞—Ñ—Ç—É'
    };

    // –î–∞–Ω–Ω—ã–µ –º–µ–Ω—é
    // –í—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–∏ —Å—Å—ã–ª–∫–∏ –≤ –ø–æ–ª–µ 'img' –∏ ID –∏–∑ iiko –≤ 'iiko_id'
    const menuItems = [
        { id: 'set1', iiko_id: '', img: '', title: '–°–µ—Ç 1', price: 1550, category: 'sets', desc: '–°—ã—Ä–Ω—ã–µ –Ω–∏—Ç–∏, —Å—É–¥–∂—É–∫, –º—è—Å–Ω—ã–µ —á–∏–ø—Å—ã, –≥—Ä–µ–Ω–∫–∏, –∫—Ä—ã–ª—å—è' },
        { id: 'set2', iiko_id: '', img: '', title: '–°–µ—Ç 2', price: 790, category: 'sets', desc: '–ö—Ä–µ–≤–µ—Ç–æ—á–Ω—ã–µ —á–∏–ø—Å—ã, —Å—ã—Ä–Ω—ã–µ —à–∞—Ä–∏–∫–∏, –ª—É–∫–æ–≤—ã–µ –∫–æ–ª—å—Ü–∞, –∫–∞–ª—å–º–∞—Ä, —Ç–∞—Ä-—Ç–∞—Ä' },
        { id: 'set3', iiko_id: '', img: '', title: '–°–µ—Ç 3', price: 1150, category: 'sets', desc: '–†–µ–±—Ä–∞ —Å–≤–∏–Ω–∏–Ω–∞, 4 –≤–∏–¥–∞ –∫–æ–ª–±–∞—Å–æ–∫, –≥—Ä–µ–Ω–∫–∏, —Å–æ—É—Å BBQ' },
        { id: 'set4', iiko_id: '', img: '', title: '–°–µ—Ç 4', price: 850, category: 'sets', desc: '–°—ã—Ä–Ω—ã–µ –Ω–∏—Ç–∏, —á–∏–ø—Å—ã, —Å—É–¥–∂—É–∫, –∞—Ä–∞—Ö–∏—Å, —Ñ–∏—Å—Ç–∞—à–∫–∏' },
        { id: 'chips', iiko_id: '', img: '', title: '–ß–∏–ø—Å—ã (30–≥)', price: 130, category: 'snacks', desc: '' },
        { id: 'shrimp_chips', iiko_id: '', img: '', title: '–ö—Ä–µ–≤–µ—Ç–æ—á–Ω—ã–µ —á–∏–ø—Å—ã (20–≥)', price: 120, category: 'snacks', desc: '' },
        { id: 'croutons', iiko_id: '', img: '', title: '–ì—Ä–µ–Ω–∫–∏ (100/30–≥)', price: 180, category: 'snacks', desc: '' },
        { id: 'cheese_threads', iiko_id: '', img: '', title: '–°—ã—Ä–Ω—ã–µ –Ω–∏—Ç–∏ (50–≥)', price: 180, category: 'snacks', desc: '' },
        { id: 'cheese_balls', iiko_id: '', img: '', title: '–°—ã—Ä–Ω—ã–µ —à–∞—Ä–∏–∫–∏ (6 —à—Ç)', price: 230, category: 'snacks', desc: '' },
        { id: 'meat_chips_pork', iiko_id: '', img: '', title: '–ú—è—Å–Ω—ã–µ —á–∏–ø—Å—ã —Å–≤–∏–Ω–∏–Ω–∞ (50–≥)', price: 260, category: 'snacks', desc: '' },
        { id: 'meat_chips_chicken', iiko_id: '', img: '', title: '–ú—è—Å–Ω—ã–µ —á–∏–ø—Å—ã –∫—É—Ä–∏—Ü–∞ (50–≥)', price: 260, category: 'snacks', desc: '' },
        { id: 'sudzhuk', iiko_id: '', img: '', title: '–°—É–¥–∂—É–∫ (50–≥)', price: 360, category: 'snacks', desc: '' },
        { id: 'peanuts', iiko_id: '', img: '', title: '–ê—Ä–∞—Ö–∏—Å (100–≥)', price: 390, category: 'snacks', desc: '' },
        { id: 'pistachios', iiko_id: '', img: '', title: '–§–∏—Å—Ç–∞—à–∫–∏ (100–≥)', price: 390, category: 'snacks', desc: '' },
        { id: 'wings', iiko_id: '', img: '', title: '–ö—É—Ä–∏–Ω—ã–µ –∫—Ä—ã–ª—å—è (200–≥)', price: 420, category: 'snacks', desc: '' },
        { id: 'ribs', iiko_id: '', img: '', title: '–†—ë–±—Ä—ã—à–∫–∏ (200–≥)', price: 560, category: 'snacks', desc: '' },
        { id: 'sausages', iiko_id: '', img: '', title: '–ö–æ–ª–±–∞—Å–∫–∏ (230/30–≥)', price: 570, category: 'snacks', desc: '' },
        { id: 'onion_rings_6', iiko_id: '', img: '', title: '–õ—É–∫–æ–≤—ã–µ –∫–æ–ª—å—Ü–∞ (6 —à—Ç)', price: 210, category: 'snacks', desc: '' },
        { id: 'onion_rings_10', iiko_id: '', img: '', title: '–õ—É–∫–æ–≤—ã–µ –∫–æ–ª—å—Ü–∞ (10 —à—Ç)', price: 310, category: 'snacks', desc: '' },
        { id: 'squid_rings_6', iiko_id: '', img: '', title: '–ö–æ–ª—å—Ü–∞ –∫–∞–ª—å–º–∞—Ä–∞ (6 —à—Ç)', price: 360, category: 'snacks', desc: '' },
        { id: 'squid_rings_10', iiko_id: '', img: '', title: '–ö–æ–ª—å—Ü–∞ –∫–∞–ª—å–º–∞—Ä–∞ (10 —à—Ç)', price: 540, category: 'snacks', desc: '' },
        { id: 'shrimp_snack', iiko_id: '', img: '', title: '–ö—Ä–µ–≤–µ—Ç–∫–∏ (150–≥)', price: 560, category: 'snacks', desc: '' }
    ];

    let cart = {};

    function render() {
        const content = document.getElementById('menu-content');
        content.innerHTML = '';

        for (const [catId, catName] of Object.entries(categories)) {
            const items = menuItems.filter(i => i.category === catId);
            if (items.length === 0) continue;

            content.innerHTML += `<div class="category-title">${catName}</div><div class="menu-container">`;
            
            items.forEach(item => {
                const imgUrl = item.img || 'https://via.placeholder.com/100?text=Food';
                content.innerHTML += `
                    <div class="item-card">
                        <div class="item-img" style="background-image: url('${imgUrl}')"></div>
                        <div class="item-info">
                            <div class="item-title">${item.title}</div>
                            <div class="item-desc">${item.desc || ''}</div>
                            <div class="item-footer">
                                <div class="item-price">${item.price} ‚ÇΩ</div>
                                <button class="add-btn" id="btn-${item.id}" onclick="change('${item.id}', 1)">–î–æ–±–∞–≤–∏—Ç—å</button>
                                <div class="counter" id="cnt-${item.id}">
                                    <button class="counter-btn" onclick="change('${item.id}', -1)">-</button>
                                    <span class="num-display" id="num-${item.id}">0</span>
                                    <button class="counter-btn" onclick="change('${item.id}', 1)">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            content.innerHTML += `</div>`;
        }
    }

    function change(id, delta) {
        cart[id] = (cart[id] || 0) + delta;
        const btn = document.getElementById('btn-' + id);
        const cnt = document.getElementById('cnt-' + id);
        const num = document.getElementById('num-' + id);

        if (cart[id] <= 0) {
            delete cart[id];
            btn.style.display = 'block';
            cnt.style.display = 'none';
        } else {
            btn.style.display = 'none';
            cnt.style.display = 'flex';
            num.innerText = cart[id];
        }
        updateMainButton();
    }

    function updateMainButton() {
        let total = 0;
        for (const id in cart) {
            const item = menuItems.find(i => i.id === id);
            total += item.price * cart[id];
        }
        if (total > 0) {
            tg.MainButton.text = `–ó–ê–ö–ê–ó–ê–¢–¨ (${total} ‚ÇΩ)`;
            tg.MainButton.show();
        } else {
            tg.MainButton.hide();
        }
    }

    tg.onEvent('mainButtonClicked', function() {
        let order = [];
        for (const id in cart) {
            const item = menuItems.find(i => i.id === id);
            order.push({ 
                title: item.title, 
                count: cart[id], 
                price: item.price,
                iiko_id: item.iiko_id // –ü–µ—Ä–µ–¥–∞–µ–º ID –∞–π–∫–∏ –≤ –±–æ—Ç
            });
        }
        const data = {
            order: order,
            time: document.getElementById('order-time').value
        };
        tg.sendData(JSON.stringify(data));
    });

    render();
</script>
</body>
</html>
